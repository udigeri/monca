<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Moneris testing</title>
        <meta name="description" content="Testing Moneris checkout" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <script src="https://gatewayt.moneris.com/chktv2/js/chkt_v2.00.js"></script>
        <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
        <link rel="stylesheet" href="styles/normalize.css" />
        <link rel="stylesheet" href="styles/style.css" />
    </head>

    <body>
        <div class="app">
            <aside>
                <h1 id="title">command</h1>
                <form>
                    <input id="ticketNumber" type="text" placeholder="TicketNr." />
                </form>
                <header class="redirect">
                    <button id="startTicketButton">Ticket</button>
                    <button id="startCheckoutButton">Checkout</button>
                    <button id="startReceiptButton">Receipt</button>
                </header>

                <div class="order">
                    <section class="header center">
                        <div class="header-text">Merchant</div>
                        <img
                            class="header-image"
                            alt="S&B logo"
                            src="https://www.scheidt-bachmann.de/fileadmin/templates/img/sblogo.svg"
                        />
                    </section>

                    <section class="order-details">
                        <span class="order-id">Order ID</span>
                        <p class="cart">
                            <svg style="stroke: #78787878" viewBox="0 0 115.35 122.88">
                                <path
                                    d="M25.27,86.92c-1.81,0-3.26-1.46-3.26-3.26s1.47-3.26,3.26-3.26h21.49c1.81,0,3.26,1.46,3.26,3.26s-1.46,3.26-3.26,3.26 H25.27L25.27,86.92L25.27,86.92z M61.1,77.47c-0.96,0-1.78-0.82-1.78-1.82c0-0.96,0.82-1.78,1.78-1.78h4.65c0.04,0,0.14,0,0.18,0 c1.64,0.04,3.1,0.36,4.33,1.14c1.37,0.87,2.37,2.19,2.92,4.15c0,0.04,0,0.09,0.05,0.14l0.46,1.82h39.89c1,0,1.78,0.82,1.78,1.78 c0,0.18-0.05,0.36-0.09,0.55l-4.65,18.74c-0.18,0.82-0.91,1.37-1.73,1.37l0,0l-29.18,0c0.64,2.37,1.28,3.65,2.14,4.24 c1.05,0.68,2.87,0.73,5.93,0.68h0.04l0,0h20.61c1,0,1.78,0.82,1.78,1.78c0,1-0.82,1.78-1.78,1.78H87.81l0,0 c-3.79,0.04-6.11-0.05-7.98-1.28c-1.92-1.28-2.92-3.46-3.92-7.43l0,0L69.8,80.2c0-0.05,0-0.05-0.04-0.09 c-0.27-1-0.73-1.69-1.37-2.05c-0.64-0.41-1.5-0.59-2.51-0.59c-0.05,0-0.09,0-0.14,0H61.1L61.1,77.47L61.1,77.47z M103.09,114.13 c2.42,0,4.38,1.96,4.38,4.38s-1.96,4.38-4.38,4.38s-4.38-1.96-4.38-4.38S100.67,114.13,103.09,114.13L103.09,114.13L103.09,114.13z M83.89,114.13c2.42,0,4.38,1.96,4.38,4.38s-1.96,4.38-4.38,4.38c-2.42,0-4.38-1.96-4.38-4.38S81.48,114.13,83.89,114.13 L83.89,114.13L83.89,114.13z M25.27,33.58c-1.81,0-3.26-1.47-3.26-3.26c0-1.8,1.47-3.26,3.26-3.26h50.52 c1.81,0,3.26,1.46,3.26,3.26c0,1.8-1.46,3.26-3.26,3.26H25.27L25.27,33.58L25.27,33.58z M7.57,0h85.63c2.09,0,3.99,0.85,5.35,2.21 s2.21,3.26,2.21,5.35v59.98h-6.5V7.59c0-0.29-0.12-0.56-0.31-0.76c-0.2-0.19-0.47-0.31-0.76-0.31l0,0H7.57 c-0.29,0-0.56,0.12-0.76,0.31S6.51,7.3,6.51,7.59v98.67c0,0.29,0.12,0.56,0.31,0.76s0.46,0.31,0.76,0.31h55.05 c0.61,2.39,1.3,4.48,2.23,6.47H7.57c-2.09,0-3.99-0.85-5.35-2.21C0.85,110.24,0,108.34,0,106.25V7.57c0-2.09,0.85-4,2.21-5.36 S5.48,0,7.57,0L7.57,0L7.57,0z M25.27,60.25c-1.81,0-3.26-1.46-3.26-3.26s1.47-3.26,3.26-3.26h50.52c1.81,0,3.26,1.46,3.26,3.26 s-1.46,3.26-3.26,3.26H25.27L25.27,60.25L25.27,60.25z"
                                ></path>
                            </svg>
                            <span>38f0d2d0-53ea-4872-a980-0d8e793aa827</span>
                        </p>
                    </section>

                    <div
                        id="outerDiv"
                        style="
                            height: 740px;
                            margin-top: 10px;
                            border: 1px solid blue;
                            border-radius: 10px;
                        "
                    >
                        <div id="monerisCheckout"></div>
                    </div>

                    <section class="footer right">
                        <div class="footer-text">Powered by</div>
                        <img
                            class="footer-image"
                            alt="Moneris Logo"
                            src="https://gatewayt.moneris.com/chktv2/style/images/mon_logo_chkt.png"
                        />
                    </section>
                </div>

                <!-- Modal window for displaying the receipt -->
                <div id="receiptModal">
                    <div id="receiptModalContent">
                        <span id="closeModal">Ã—</span>
                        <h2>Payment Receipt</h2>
                        <div id="receiptDetails"></div>
                    </div>
                </div>
            </aside>
            <main>
                <h1 id="title">Log</h1>
                <div id="rsp" class="rsp"></div>
            </main>
            <script>
                const queryParams = new URLSearchParams(window.location.search);
                document.getElementById("ticketNumber").value = queryParams.get("tck");

                for (const param of queryParams) {
                    console.log(param);
                }
                // Execute a function when the user presses a key on the keyboard
                document
                    .getElementById("ticketNumber")
                    .addEventListener("keypress", function (event) {
                        if (event.key === "Enter") {
                            event.preventDefault();
                            document.getElementById("startCheckoutButton").click();
                        }
                    });

                // Event listener for the start checkout button
                document.getElementById("startTicketButton").addEventListener("click", function () {
                    initializeMonerisTicket();
                });
                // Event listener for the start checkout button
                document
                    .getElementById("startCheckoutButton")
                    .addEventListener("click", function () {
                        var ticketNumber = document.getElementById("ticketNumber").value;
                        if (ticketNumber) {
                            initializeMonerisCheckout(ticketNumber);
                        } else {
                            alert("Please enter a ticket number.");
                        }
                    });
                // Event listener for the start receipt button
                document
                    .getElementById("startReceiptButton")
                    .addEventListener("click", function () {
                        var ticketNumber = document.getElementById("ticketNumber").value;
                        if (ticketNumber) {
                            initializeMonerisReceipt(ticketNumber);
                        } else {
                            alert("Please enter a ticket number.");
                        }
                    });
                // Close the modal when the user clicks on <span> (x)
                document.getElementById("closeModal").onclick = function () {
                    document.getElementById("receiptModal").style.display = "none";
                };

                // Close the modal when the user clicks anywhere outside of the modal
                window.onclick = function (event) {
                    if (event.target == document.getElementById("receiptModal")) {
                        document.getElementById("receiptModal").style.display = "none";
                    }
                };
            </script>
            <script src="js/moneris.js"></script>
        </div>
    </body>
</html>
